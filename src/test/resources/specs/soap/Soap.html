<html xmlns:e="http://exam.extension.io">
<body>
<e:summary/>
<e:given>
    Given server, that mirrors request
</e:given>
<e:example name="Check body - success" print="true">
    <e:soap url="relative/url">
        <e:case desc="Content can be inlined">
            <body>
            <![CDATA[
            <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                <soap:Body>
                    <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                        <date>${exam.now:yyyy-MM-dd}</date>
                    </ns2:getItemRequest>
                </soap:Body>
            </soap:Envelope>
            ]]>
            </body>
            <expected>
                <![CDATA[
                <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                    <soap:Body>
                        <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                            <date>${exam.now:yyyy-MM-dd}</date>
                        </ns2:getItemRequest>
                    </soap:Body>
                </soap:Envelope>
                ]]>
            </expected>
        </e:case>
        <e:case desc="Or stored in file">
            <body from="/data/soap/${#body}"/>
            <expected from="/data/soap/expected.xml"/>
            <where vars="body">
                <vals>body.xml</vals>
            </where>
        </e:case>
    </e:soap>
</e:example>
<e:example name="Check body - failed" status="ExpectedToFail" print="true">
    <e:soap url="relative/url">
        <e:case desc="Happy-path">
            <body>
            <![CDATA[
            <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                <soap:Body>
                    <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                        <date>${exam.now:yyyy-MM-dd}</date>
                    </ns2:getItemRequest>
                </soap:Body>
            </soap:Envelope>
            ]]>
            </body>
            <expected>
                <![CDATA[
                <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                    <soap:Body>
                        <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                            <date>${exam.now+[1 day]:yyyy-MM-dd}</date>
                        </ns2:getItemRequest>
                    </soap:Body>
                </soap:Envelope>
                ]]>
            </expected>
        </e:case>
    </e:soap>
</e:example>
<e:example name="Placeholder support" print="true">
    <e:soap url="relative/url">
        <e:case desc="Happy-path">
            <body >
            <![CDATA[
            <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                <soap:Body>
                    <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                        <val>${#val}</val>
                    </ns2:getItemRequest>
                </soap:Body>
            </soap:Envelope>
            ]]>
            </body>
            <expected>
                <![CDATA[
                <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                    <soap:Body>
                        <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                            <val>${#placeholder}</val>
                        </ns2:getItemRequest>
                    </soap:Body>
                </soap:Envelope>
                ]]>
            </expected>
            <where vars="val, placeholder">
                <vals>3,           !{number}</vals>
                <vals>hi,          !{string}</vals>
                <vals>true,        !{bool}</vals>
                <vals>a,           !{regex}[abc]</vals>
                <vals>22.01.2000,  !{formattedAs dd.mm.yyyy}</vals>
                <vals>anything,    !{ignore}</vals>
            </where>
        </e:case>
    </e:soap>
</e:example>
<e:example name="Placeholder support - fail" status="ExpectedToFail" print="true">
    <e:soap url="relative/url">
        <e:case desc="Happy-path">
            <body >
            <![CDATA[
            <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                <soap:Body>
                    <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                        <val>${#val}</val>
                    </ns2:getItemRequest>
                </soap:Body>
            </soap:Envelope>
            ]]>
            </body>
            <expected>
                <![CDATA[
                <soap:Envelope xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">
                    <soap:Body>
                        <ns2:getItemRequest xmlns:ns2="http://ws.marketplace.core.tcsbank.ru">
                            <val>${#placeholder}</val>
                        </ns2:getItemRequest>
                    </soap:Body>
                </soap:Envelope>
                ]]>
            </expected>
            <where vars="val, placeholder">
                <vals>three,       !{number}</vals>
                <vals>3,           !{string}</vals>
                <vals>1,           !{boolean}</vals>
                <vals>d,           !{regex}[abc]</vals>
                <vals>22/01/2000,  !{formattedAs dd.mm.yyyy}</vals>
            </where>
        </e:case>
    </e:soap>
</e:example>
</body>
</html>